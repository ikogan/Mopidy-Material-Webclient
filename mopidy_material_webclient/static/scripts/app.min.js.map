{"version":3,"sources":["../src/app.js","../src/controllers.js","../src/services.js"],"names":["app","angular","module","config","$mdThemingProvider","theme","primaryPalette","accentPalette","$routeProvider","when","templateUrl","controller","otherwise","redirectTo","controllers","$scope","$mdSidenav","$mdDialog","$mdToast","$location","$http","mopidy","lastfm","settings","showNowPlaying","get","then","title","host","m","playback","getCurrentTrack","done","track","$apply","nowPlaying","getInfo","getState","state","tracklist","getLength","length","on","console","log","bind","e","new_state","tl_track","errback","play","pause","artists","getTrack","success","trackInfo","t","album","image","images","i","push","goTo","path","toggle","toggleSidenav","menuId","system","$event","DialogController","action","value","hide","closeDialog","cancel","show","targetEvent","template","response","post","simple","content","message","hideDelay","$routeParams","$window","$mdBottomSheet","$sce","type","uri","decodeURIComponent","loading","library","browse","uris","getImages","img","indexOf","lookup","info","tracks","artist","al","name","ar","getAlbum","albumInfo","getArtist","artistInfo","playlists","playlist","favourites","create","newPlaylist","asTrusted","summary","trustAsHtml","getFontIcon","ref","toLowerCase","encodeURIComponent","playAll","clear","add","back","history","search","query","showTrackActions","child","$new","isFavourite","some","itm","scope","clickedItem","getCurrentTlTrack","current","index","addToFavourites","removeFromFavourites","save","splice","isPlaylist","refresh","asList","getTlTracks","tltrack","playing","getRandom","enabled","randomOn","getRepeat","repeatOn","tlid","previous","next","toggleRandom","setRandom","toggleRepeat","setRepeat","remove","setConsume","SaveDialogController","parent","element","document","body","position","albums","albumsLoading","artistsLoading","tracksLoading","any","results","j","k","l","wifi","network","wifi_network","networks","ssid","data","JSON","parse","stringify","Date","now","extensions","forEach","key","checkForUpdates","latest","update","method","url","headers","Content-Type","listItemClick","services","factory","$q","Mopidy","resolve","reject","updatePageTitle","map","join","service","deferred","defer","hasOwnProperty","subitm","promise"],"mappings":"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","file":"app.min.js","sourcesContent":["var app = angular.module('MopidyApp', ['ngRoute', 'ngMaterial', 'mopControllers', 'mopServices']);\n\napp.config(function($mdThemingProvider) {\n    $mdThemingProvider.theme('default')\n        .primaryPalette('deep-purple')\n        .accentPalette('pink');\n});\n\napp.config(['$routeProvider',\n    function ($routeProvider) {\n        $routeProvider.\n            when('/queue', {\n                templateUrl: 'partials/queue.html',\n                controller: 'QueueCtrl'\n            }).\n            when('/library', {\n                templateUrl: 'partials/library.html',\n                controller: 'LibraryCtrl'\n            }).\n            when('/library/:type/:uri', {\n                templateUrl: 'partials/library.html',\n                controller: 'LibraryCtrl'\n            }).\n            when('/playlists', {\n                templateUrl: 'partials/playlists.html',\n                controller: 'PlaylistsCtrl'\n            }).\n            when('/playlists/:uri', {\n                templateUrl: 'partials/playlists.html',\n                controller: 'PlaylistsCtrl'\n            }).\n            when('/search/:uri/:query', {\n                templateUrl: 'partials/search.html',\n                controller: 'SearchCtrl'\n            }).\n            when('/settings', {\n                templateUrl: 'partials/settings.html',\n                controller: 'SettingsCtrl'\n            }).\n            when('/about', {\n                templateUrl: 'partials/about.html',\n                controller: 'AboutCtrl'\n            })\n            .otherwise({\n                redirectTo: '/queue'\n            });\n  }]);","var controllers = angular.module('mopControllers', []);\n\ncontrollers.controller('AppCtrl', [\n    '$scope', '$mdSidenav', '$mdDialog', '$mdToast', '$location', '$http', 'mopidy', 'lastfm', 'settings',\n    function ($scope, $mdSidenav, $mdDialog, $mdToast, $location, $http, mopidy, lastfm, settings) {\n        // Start now playing off as hidden. We'll show it once we have a QueueCtrl\n        $scope.showNowPlaying = false;\n\n        settings.get().then(function(settings) {\n            $scope.settings = settings['material-webclient'];\n\n            if($scope.settings.title) {\n                $scope.title = $scope.settings.title;\n            } else {\n                $scope.title = $location.host();\n            }\n        });\n\n        mopidy.then(function (m) {\n            m.playback.getCurrentTrack()\n                .done(function (track) {\n                    $scope.$apply(function () {\n                        $scope.nowPlaying = track;\n                        $scope.getInfo($scope.nowPlaying);\n                    });\n                });\n\n            m.playback.getState()\n                .done(function (state) {\n                    $scope.$apply(function () {\n                        $scope.state = state;\n                    });\n                });\n\n            m.tracklist.getLength().then(function(length) {\n                if(length > 0) {\n                    $scope.showNowPlaying = true;\n                }\n            })\n\n            m.on(console.log.bind(console));\n\n            m.on('event:tracklistChanged', function(e) {\n                m.tracklist.getLength().then(function(length) {\n                    $scope.showNowPlaying = (length > 0);\n                })\n            });\n\n            m.on('event:playbackStateChanged', function (e) {\n                $scope.$apply(function () {\n                    $scope.state = e.new_state;\n                });\n            });\n\n            m.on('event:trackPlaybackStarted', function (e) {\n                $scope.$apply(function () {\n                    $scope.nowPlaying = e.tl_track.track;\n                    $scope.getInfo($scope.nowPlaying);\n                });\n            });\n\n            m.errback = function (e) {\n                console.log(e);\n            };\n\n            $scope.play = function () {\n                m.playback.play();\n            };\n\n            $scope.pause = function () {\n                m.playback.pause();\n            };\n        });\n\n        $scope.getInfo = function (track) {\n            if (!track || track.artists.length === 0) {\n                return;\n            }\n            lastfm.getTrack(track).success(function (trackInfo) {\n                var t = trackInfo.track;\n                if (!t) {\n                    return;\n                }\n\n                if (t.album &&\n                    t.album.image &&\n                    t.album.image.length > 0) {\n                    $scope.nowPlaying.album = t.album;\n                    $scope.nowPlaying.album.images = [];\n                    for (var i = 0; i < t.album.image.length; i++) {\n                        $scope.nowPlaying.album.images.push(t.album.image[i]['#text']);\n                    }\n                }\n            });\n        };\n\n        $scope.goTo = function (path) {\n            $location.path(path);\n            $mdSidenav('left').toggle();\n        };\n\n        $scope.toggleSidenav = function (menuId) {\n            $mdSidenav(menuId).toggle();\n        };\n\n        $scope.system = function ($event) {\n\n            function DialogController($scope, $mdDialog) {\n                $scope.action = function (value) {\n                    $mdDialog.hide(value);\n                };\n                $scope.closeDialog = function () {\n                    $mdDialog.cancel();\n                };\n            }\n\n            $mdDialog.show({\n                targetEvent: $event,\n                template:\n                    '<md-dialog aria-label=\"List dialog\">' +\n                        '  <md-dialog-content>' +\n                        '    <md-list>' +\n                        '      <md-list-item ng-click=\"action(\\'restart\\')\">' +\n                        '        <md-icon class=\"md-accent\">refresh</md-icon><p>Restart</p>' +\n                        '      </md-list-item>' +\n                        '      <md-list-item ng-click=\"action(\\'about\\')\">' +\n                        '        <md-icon class=\"md-accent\">info</md-icon><p>About</p>' +\n                        '      </md-list-item>' +\n                        '      <md-list-item ng-click=\"closeDialog()\">' +\n                        '        <md-icon>cancel</md-icon><p>Cancel</p>' +\n                        '      </md-list-item>' +\n                        '    </md-list>' +\n                        '  </md-dialog-content>' +\n                        '</md-dialog>',\n                controller: DialogController\n            }).then(function (response) {\n                if (response == 'about') {\n                    $location.path('about');\n                } else if (response == 'restart') {\n                    $http.post('/material-webclient/restart').success(function (response) {\n                        $mdToast.show(\n                            $mdToast.simple()\n                            .content(response.message)\n                            .hideDelay(3000)\n                        );\n                    });\n                }\n                console.log(response);\n            });\n        };\n    }\n]);\n\ncontrollers.controller('LibraryCtrl', [\n    '$scope', '$routeParams', '$location', '$window', '$mdBottomSheet', '$sce', 'mopidy', 'lastfm',\n    function ($scope, $routeParams, $location, $window, $mdBottomSheet, $sce, mopidy, lastfm) {\n        var type = null;\n        var uri = null;\n\n        if ($routeParams.type) {\n            type = decodeURIComponent($routeParams.type);\n        }\n        if ($routeParams.uri) {\n            uri = decodeURIComponent($routeParams.uri);\n            $scope.uri = uri;\n        }\n\n        $scope.loading = true;\n\n        mopidy.then(function (m) {\n            $scope.mopidy = m;\n            m.library.browse(uri).done(\n                function (content) {\n                    var uris = [];\n\n                    $scope.$apply(function () {\n                        $scope.content = content;\n                        $scope.loading = false;\n                    });\n\n                    for (var i = 0; i < content.length; i++) {\n                        if (content[i].type == 'track') {\n                            uris.push(content[i].uri);\n                        }\n                    }\n\n                    if (type) {\n                        m.library.getImages(uris).done(function (images) {\n                            $scope.$apply(function () {\n                                for (var i = 0; i < $scope.content.length; i++) {\n                                    var img = images[$scope.content[i].uri];\n                                    if (img && img.length > 0) {\n                                        $scope.content[i].image = img[0].uri;\n                                    }\n                                }\n                            });\n                        });\n                    }\n                });\n\n            if (type &&\n                type != 'directory' &&\n                uri.indexOf('podcast') !== 0) {\n                m.library.lookup(uri).done(function (info) {\n                    $scope.tracks = info;\n                    var album;\n                    var artist;\n                    if (info.length > 0) {\n                        album = info[0].album;\n                        artist = info[0].artists && info[0].artists.length > 0 ? info[0].artists[0] : null;\n                    }\n\n                    for (var i = 1; i < info.length; i++) {\n                        var al = info[i].album;\n                        if (album && al && al.name != album.name) {\n                            album = null;\n                        }\n                        var ar = info[i].artists && info[i].artists.length > 0 ? info[i].artists[0] : null;\n                        if (artist && ar && ar.name != artist.name) {\n                            artist = null;\n                        }\n                    }\n\n                    if (type == 'album' && album) {\n                        lastfm.getAlbum(album).success(function (albumInfo) {\n                            $scope.albumInfo = albumInfo.album;\n                        });\n                    }\n\n                    if (type == 'artist' && artist) {\n                        lastfm.getArtist(artist).success(function (artistInfo) {\n                            $scope.artistInfo = artistInfo.artist;\n                        });\n                    }\n                });\n            }\n\n            m.playlists.lookup('m3u:Favourites.m3u').done(function (playlist) {\n                if (!playlist) {\n                    m.playlists.create('Favourites', 'm3u').done(function (newPlaylist) {\n                        $scope.favourites = newPlaylist;\n                    });\n                } else {\n                    $scope.favourites = playlist;\n                }\n            });\n        });\n\n        $scope.asTrusted = function (summary) {\n            return $sce.trustAsHtml(summary);\n        };\n\n        $scope.getFontIcon = function (ref) {\n            if (ref.type.toLowerCase() == 'track') {\n                return 'fa-music';\n            } else {\n                if (ref.uri.indexOf('spotify') === 0) {\n                    return 'fa-spotify';\n                } else if (ref.uri.indexOf('tunein:') === 0) {\n                    return 'fa-headphones';\n                } else if (ref.uri.indexOf('podcast:') === 0) {\n                    return 'fa-rss';\n                } else if (ref.uri.indexOf('soundcloud:') === 0) {\n                    return 'fa-soundcloud';\n                } else {\n                    return 'fa-folder-o';\n                }\n            }\n        };\n\n        $scope.goTo = function (ref) {\n            if (ref.type != 'track') {\n                $location.path('library/' + ref.type + '/' + encodeURIComponent(ref.uri));\n            } else {\n                $scope.mopidy.play(ref.uri);\n            }\n        };\n\n        $scope.playAll = function () {\n            $scope.mopidy.tracklist.clear();\n            var uris = [];\n            for (var i = 0; i < $scope.tracks.length; i++) {\n                uris.push($scope.tracks[i].uri);\n            }\n            $scope.mopidy.tracklist.add(null, null, null, uris).then(function () {\n                $scope.mopidy.playback.play();\n            });\n        };\n\n        $scope.back = function () {\n            $window.history.back();\n        };\n\n        $scope.search = function (uri, query) {\n            $location.path('search/' + encodeURIComponent(uri) + '/' + encodeURIComponent(query));\n        };\n\n        $scope.showTrackActions = function ($event, track) {\n\n            var child = $scope.$new();\n\n            if ($scope.favourites.tracks) {\n                child.isFavourite = $scope.favourites.tracks.some(function (itm) {\n                    return itm.uri == track.uri;\n                });\n            }\n\n            $mdBottomSheet.show({\n                templateUrl: 'partials/track-actions.html',\n                controller: 'TrackActionsCtrl',\n                targetEvent: $event,\n                scope: child\n            }).then(function (clickedItem) {\n                if (clickedItem == 'play-next') {\n                    $scope.mopidy.playback.getCurrentTlTrack().done(function (current) {\n                        console.log(current);\n                        $scope.mopidy.tracklist.index(current).done(function (index) {\n                            $scope.mopidy.tracklist.add(null, index + 1, null, [track.uri]);\n                        });\n                    });\n                } else if (clickedItem == 'add-to-queue') {\n                    $scope.mopidy.tracklist.add(null, null, null, [track.uri]);\n                } else if (clickedItem == 'add-to-favourites') {\n                    $scope.addToFavourites(track.uri);\n                } else if (clickedItem == 'remove-from-favourites') {\n                    $scope.removeFromFavourites(track.uri);\n                }\n            });\n        };\n\n        $scope.addToFavourites = function (uri) {\n            $scope.mopidy.library.lookup(uri).done(function (tracks) {\n                if (!$scope.favourites.tracks) {\n                    $scope.favourites.tracks = tracks;\n                } else {\n                    $scope.favourites.tracks.push(tracks[0]);\n                }\n                $scope.mopidy.playlists.save($scope.favourites).done(function (playlist) {\n                    $scope.favourites = playlist;\n                });\n            });\n        };\n\n        $scope.removeFromFavourites = function (uri) {\n            for (var i = 0; i < $scope.favourites.tracks.length; i++) {\n                if ($scope.favourites.tracks[i].uri == uri) {\n                    $scope.favourites.tracks.splice(i, 1);\n                }\n            }\n            $scope.mopidy.playlists.save($scope.favourites).done(function (playlist) {\n                $scope.favourites = playlist;\n            });\n        };\n    }\n]);\n\ncontrollers.controller('PlaylistsCtrl', [\n    '$scope', '$routeParams', '$location', 'mopidy',\n    function ($scope, $routeParams, $location, mopidy) {\n        var uri = $routeParams.uri;\n\n        mopidy.then(function (m) {\n            $scope.mopidy = m;\n            if (uri) {\n                $scope.isPlaylist = true;\n                m.playlists.lookup(uri).done(\n                    function (playlist) {\n                        $scope.$apply(function () {\n                            $scope.playlist = playlist;\n                            $scope.content = playlist.tracks;\n\n                            var uris = [];\n                            for (var i = 0; i < $scope.content.length && i < 9; i++) {\n                                uris.push($scope.content[i].uri);\n                            }\n\n                            m.library.getImages(uris).done(function (images) {\n                                $scope.$apply(function () {\n                                    $scope.images = [];\n                                    for (var i = 0; i < uris.length; i++) {\n                                        if (images[uris[i]] && images[uris[i]].length > 0) {\n                                            $scope.images.push(images[uris[i]][0].uri);\n                                        }\n                                    }\n                                });\n                            });\n                        });\n                    });\n            } else {\n                m.playlists.refresh().done(function () {\n                    m.playlists.asList().done(\n                        function (content) {\n                            $scope.$apply(function () {\n                                $scope.content = content;\n                            });\n                        });\n                });\n            }\n        });\n\n        $scope.getFontIcon = function (ref) {\n            if (ref.uri.indexOf('spotify') === 0) {\n                return 'fa-spotify';\n            } else if (ref.uri.indexOf('tunein:') === 0) {\n                return 'fa-headphones';\n            } else if (ref.uri.indexOf('podcast') === 0) {\n                return 'fa-rss';\n            } else if (ref.uri.indexOf('soundcloud') === 0) {\n                return 'fa-soundcloud';\n            } else if ($scope.isPlaylist) {\n                return 'fa-music';\n            } else {\n                return 'fa-folder-o';\n            }\n        };\n\n        $scope.goTo = function (ref) {\n            if ($scope.isPlaylist) {\n                $scope.mopidy.tracklist.clear();\n                $scope.mopidy.tracklist.add(null, null, null, [ref.uri])\n                    .then(function () {\n                        $scope.mopidy.playback.play();\n                    });\n            } else {\n                $location.path('playlists/' + ref.uri);\n            }\n        };\n\n        $scope.playAll = function () {\n            $scope.mopidy.tracklist.clear().done(function () {\n                var uris = [];\n                for (var i = 0; i < $scope.content.length; i++) {\n                    uris.push($scope.content[i].uri);\n                }\n                $scope.mopidy.tracklist.add(null, null, null, uris).done(function () {\n                    $scope.mopidy.playback.play();\n                });\n            });\n        };\n    }\n]);\n\ncontrollers.controller('QueueCtrl', [\n    '$scope', '$mdDialog', '$mdToast', 'mopidy', 'lastfm',\n    function ($scope, $mdDialog, $mdToast, mopidy, lastfm) {\n        mopidy.then(function (m) {\n\n            $scope.mopidy = m;\n            m.tracklist.getTlTracks().then(function (tracks) {\n                $scope.$apply(function () {\n                    $scope.tracks = tracks;\n                });\n\n                m.playback.getCurrentTlTrack()\n                    .done(function (tltrack) {\n                        $scope.$apply(function () {\n                            $scope.playing = tltrack;\n                            $scope.loading = false;\n                            if (tltrack) {\n                                $scope.getInfo(tltrack.track);\n                            }\n                        });\n                    });\n            });\n\n            m.tracklist.getRandom().done(function (enabled) {\n                $scope.$apply(function () {\n                    $scope.randomOn = enabled;\n                });\n            });\n\n            m.tracklist.getRepeat().done(function (enabled) {\n                $scope.$apply(function () {\n                    $scope.repeatOn = enabled;\n                });\n            });\n\n            m.on('event:tracklistChanged', function () {\n                m.tracklist.getTlTracks().then(function (tracks) {\n                    $scope.$apply(function () {\n                        $scope.tracks = tracks;\n                    });\n                });\n            });\n\n            m.playback.getState()\n                .done(function (state) {\n                    $scope.$apply(function () {\n                        $scope.state = state;\n                    });\n                });\n\n            m.on('event:playbackStateChanged', function (e) {\n                $scope.$apply(function () {\n                    $scope.state = e.new_state;\n                });\n            });\n\n            m.on('event:trackPlaybackStarted', function (e) {\n                $scope.$apply(function () {\n                    $scope.playing = e.tl_track;\n                    $scope.getInfo($scope.nowPlaying);\n                });\n            });\n        });\n\n        $scope.getInfo = function (track) {\n            if (!track || track.artists.length === 0) {\n                return;\n            }\n            lastfm.getTrack(track).success(function (trackInfo) {\n                var t = trackInfo.track;\n                if (!t) {\n                    return;\n                }\n\n                if (t.album &&\n                    t.album.image &&\n                    t.album.image.length > 0) {\n                    $scope.playing.track.album = t.album;\n                    $scope.playing.track.album.images = [];\n                    for (var i = 0; i < t.album.image.length; i++) {\n                        $scope.playing.track.album.images.push(t.album.image[i]['#text']);\n                    }\n                }\n            });\n        };\n\n        $scope.play = function (track) {\n            if ($scope.state == 'playing' && track.tlid == $scope.playing.tlid) {\n                $scope.mopidy.playback.pause();\n            } else {\n                $scope.mopidy.playback.play(track);\n            }\n        };\n\n        $scope.previous = function () {\n            $scope.mopidy.playback.previous();\n        };\n\n        $scope.next = function () {\n            $scope.mopidy.playback.next();\n        };\n\n        $scope.toggleRandom = function () {\n            $scope.mopidy.tracklist.setRandom(!$scope.randomOn).done(\n                function () {\n                    $scope.$apply(function () {\n                        $scope.randomOn = !$scope.randomOn;\n                    });\n                });\n        };\n\n        $scope.toggleRepeat = function () {\n            $scope.mopidy.tracklist.setRepeat(!$scope.repeatOn).done(\n                function () {\n                    $scope.$apply(function () {\n                        $scope.repeatOn = !$scope.repeatOn;\n                    });\n                });\n        };\n\n        $scope.remove = function (track) {\n            $scope.mopidy.tracklist.remove({ tlid: [track.tlid] });\n        };\n\n        $scope.clear = function () {\n            $scope.mopidy.tracklist.clear();\n        };\n\n        $scope.setConsume = function () {\n            $scope.mopidy.tracklist.setConsume(true).then();\n        };\n\n        $scope.save = function ($event) {\n            $mdDialog.show({\n                targetEvent: $event,\n                parent: angular.element(document.body),\n                template:\n                    '<md-dialog aria-label=\"Save playlist\" flex=\"20\">' +\n                        '  <md-dialog-content>' +\n                        '    <h3 class=\"md-title\">New playlist</h3>' +\n                        '    <form>' +\n                        '      <md-input-container flex>' +\n                        '        <label>Name</label>' +\n                        '        <input type=\"text\" required ng-model=\"name\"/>' +\n                        '      </md-input-container>' +\n                        '    </form>' +\n                        '  </md-dialog-content>' +\n                        '  <div class=\"md-actions\">' +\n                        '    <md-button ng-click=\"cancel()\" class=\"md-primary\">' +\n                        '      Cancel' +\n                        '    </md-button>' +\n                        '    <md-button ng-click=\"save()\" class=\"md-primary\">' +\n                        '      Create playlist' +\n                        '    </md-button>' +\n                        '  </div>' +\n                        '</md-dialog>',\n                controller: SaveDialogController\n            }).then(function (name) {\n                if (!name) {\n                    return;\n                }\n\n                $scope.mopidy.playlists.create(name, 'm3u').done(function (newPlaylist) {\n                    newPlaylist.tracks = [];\n                    for (var i = 0; i < $scope.tracks.length; i++) {\n                        newPlaylist.tracks.push($scope.tracks[i].track);\n                    }\n                    $scope.mopidy.playlists.save(newPlaylist).done(function (playlist) {\n                        $mdToast.show(\n                            $mdToast.simple()\n                            .content('New playlist ' + playlist.name + ' created')\n                            .position('bottom')\n                            .hideDelay(1500)\n                        );\n                    });\n                });\n            });\n\n            function SaveDialogController($scope, $mdDialog) {\n                $scope.cancel = function () {\n                    $mdDialog.cancel();\n                };\n                $scope.save = function () {\n                    $mdDialog.hide($scope.name);\n                };\n            }\n        };\n    }\n]);\n\ncontrollers.controller('SearchCtrl', [\n    '$scope', '$routeParams', '$mdBottomSheet', '$location', 'mopidy',\n    function ($scope, $routeParams, $mdBottomSheet, $location, mopidy) {\n\n        $scope.albums = [];\n        $scope.albumsLoading = true;\n        $scope.artists = [];\n        $scope.artistsLoading = true;\n        $scope.tracks = [];\n        $scope.tracksLoading = true;\n\n        var uri = decodeURIComponent($routeParams.uri);\n        var query = decodeURIComponent($routeParams.query);\n\n        mopidy.then(function (m) {\n            $scope.mopidy = m;\n            m.library.search({ 'any': query }, [uri]).then(function (results) {\n                $scope.$apply(function () {\n                    for (var i = 0; i < results.length; i++) {\n                        var library = results[i];\n\n                        $scope.albumsLoading = false;\n                        if (library.albums) {\n                            for (var j = 0; j < library.albums.length; j++) {\n                                $scope.albums.push(library.albums[j]);\n                            }\n                        }\n\n                        $scope.artistsLoading = false;\n                        if (library.artists) {\n                            for (var k = 0; k < library.artists.length; k++) {\n                                $scope.artists.push(library.artists[k]);\n                            }\n                        }\n\n                        $scope.tracksLoading = false;\n                        if (library.tracks) {\n                            for (var l = 0; l < library.tracks.length; l++) {\n                                $scope.tracks.push(library.tracks[l]);\n                            }\n                        }\n                    }\n                });\n\n                console.log(results);\n            });\n\n            m.playlists.lookup('m3u:Favourites.m3u').done(function (playlist) {\n                if (!playlist) {\n                    m.playlists.create('Favourites', 'm3u').done(function (newPlaylist) {\n                        $scope.favourites = newPlaylist;\n                    });\n                } else {\n                    $scope.favourites = playlist;\n                }\n            });\n        });\n\n        $scope.goto = function (type, uri) {\n            $location.path('library/' + type + '/' + encodeURIComponent(uri));\n        };\n\n        $scope.play = function (track) {\n            $scope.mopidy.play(track.uri);\n        };\n\n        $scope.showTrackActions = function ($event, track) {\n\n            var child = $scope.$new();\n\n            if ($scope.favourites.tracks) {\n                child.isFavourite = $scope.favourites.tracks.some(function (itm) {\n                    return itm.uri == track.uri;\n                });\n            }\n\n            $mdBottomSheet.show({\n                templateUrl: 'partials/track-actions.html',\n                controller: 'TrackActionsCtrl',\n                targetEvent: $event,\n                scope: child\n            }).then(function (clickedItem) {\n                if (clickedItem == 'play-next') {\n                    $scope.mopidy.playback.getCurrentTlTrack().done(function (current) {\n                        console.log(current);\n                        $scope.mopidy.tracklist.index(current).done(function (index) {\n                            $scope.mopidy.tracklist.add(null, index + 1, null, [track.uri]);\n                        });\n                    });\n                } else if (clickedItem == 'add-to-queue') {\n                    $scope.mopidy.tracklist.add(null, null, null, [track.uri]);\n                } else if (clickedItem == 'add-to-favourites') {\n                    $scope.addToFavourites(track.uri);\n                } else if (clickedItem == 'remove-from-favourites') {\n                    $scope.removeFromFavourites(track.uri);\n                }\n            });\n        };\n\n        $scope.addToFavourites = function (uri) {\n            $scope.mopidy.library.lookup(uri).done(function (tracks) {\n                if (!$scope.favourites.tracks) {\n                    $scope.favourites.tracks = tracks;\n                } else {\n                    $scope.favourites.tracks.push(tracks[0]);\n                }\n                $scope.mopidy.playlists.save($scope.favourites).done(function (playlist) {\n                    $scope.favourites = playlist;\n                });\n            });\n        };\n\n        $scope.removeFromFavourites = function (uri) {\n            for (var i = 0; i < $scope.favourites.tracks.length; i++) {\n                if ($scope.favourites.tracks[i].uri == uri) {\n                    $scope.favourites.tracks.splice(i, 1);\n                }\n            }\n            $scope.mopidy.playlists.save($scope.favourites).done(function (playlist) {\n                $scope.favourites = playlist;\n            });\n        };\n    }\n]);\n\ncontrollers.controller('SettingsCtrl', [\n    '$scope', '$http', '$mdToast', 'settings',\n    function ($scope, $http, $mdToast, settings) {\n        settings.get().then(function (settings) {\n            $scope.wifi = $scope.wifi ? $scope.wifi : [];\n            $scope.settings = settings;\n            if ($scope.wifi.indexOf(settings.network.wifi_network) < 0) {\n                $scope.wifi.push(settings.network.wifi_network);\n            }\n        });\n\n        $http.get('/material-webclient/wifi').success(function (networks) {\n            $scope.wifi = $scope.wifi ? $scope.wifi : [];\n            for (var i = 0; i < networks.length; i++) {\n                if ($scope.wifi.indexOf(networks[i].ssid) < 0) {\n                    $scope.wifi.push(networks[i].ssid);\n                }\n            }\n        });\n\n        $scope.save = function () {\n            var data = JSON.parse(JSON.stringify($scope.settings));\n            settings.save(data).then(function() {\n                $mdToast.show(\n                    $mdToast.simple()\n                        .content(response.message)\n                        .hideDelay(3000)\n                );\n            });\n        };\n    }\n]);\n\ncontrollers.controller('AboutCtrl', [\n    '$scope', '$http', '$mdToast',\n    function ($scope, $http, $mdToast) {\n        $scope.loading = true;\n\n        $scope.refresh = function () {\n            $http.get('/material-webclient/extensions?' + Date.now()).success(function (response) {\n                $scope.loading = false;\n                var extensions = {};\n                angular.forEach(response, function (value, key) {\n                    if (key.indexOf('Mopidy') >= 0) {\n                        extensions[key] = { current: value };\n                    }\n                });\n                $scope.extensions = extensions;\n            });\n        };\n\n        $scope.refresh();\n\n        $scope.checkForUpdates = function () {\n            $scope.loading = true;\n            $http.get('/material-webclient/extensions?outdated=true&' + Date.now()).success(function (response) {\n                var message = 'No updates found';\n                for (var itm in response) {\n                    if ($scope.extensions[itm]) {\n                        $scope.extensions[itm].latest = response[itm].latest;\n                        message = 'Updates found for installed modules';\n                    }\n                }\n                $scope.loading = false;\n                $mdToast.show(\n                    $mdToast.simple()\n                        .content(message)\n                        .hideDelay(3000)\n                );\n            });\n        };\n\n        $scope.update = function (name) {\n            $http({\n                method: 'POST',\n                url: '/material-webclient/extensions',\n                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n                data: 'extension=' + name\n            }).success(function (response) {\n                $mdToast.show(\n                    $mdToast.simple()\n                        .content(response.message)\n                        .hideDelay(3000)\n                );\n            });\n        };\n    }]);\n\ncontrollers.controller('TrackActionsCtrl', function ($scope, $mdBottomSheet) {\n    $scope.listItemClick = function (clickedItem) {\n        $mdBottomSheet.hide(clickedItem);\n    };\n});\n","var services = angular.module('mopServices', []);\n\nservices.factory('mopidy', ['$q',\n    function ($q) {\n        var mopidy = new Mopidy();\n        return $q(function (resolve, reject) {\n            mopidy.on(\"state:online\", function () {\n                resolve(mopidy);\n\n                mopidy.playback.getCurrentTlTrack()\n                    .done(function (tltrack) {\n                        mopidy.nowPlaying = tltrack;\n                        // TODO: Unsure how to get the current value from a promise, must inventigate\n                        updatePageTitle('playing', mopidy.nowPlaying);\n                    });\n\n                mopidy.on('event:trackPlaybackStarted', function (e) {\n                    mopidy.nowPlaying = e.tl_track.track;\n                    updatePageTitle('playing', mopidy.nowPlaying);\n                });\n\n                mopidy.on('event:playbackStateChanged', function (e) {\n                    updatePageTitle(e.new_state, mopidy.nowPlaying);\n                });\n\n                updatePageTitle = function(state, track) {\n                    if (typeof track.artists != 'undefined') {\n                        var artists = track.artists.map(\n                            function(artist){\n                                return artist.name;\n                            }).join(\", \");\n                    }\n\n                    var title = '';\n                    if (state == 'playing') {\n                        title = '\\u25B6 ' + track.name + ' - ' + artists + ' | Mopidy';\n                    } else if (state == 'paused') {\n                        title = '\\u2759\\u2759 ' + track.name + ' - ' + artists + ' | Mopidy';\n                    } else {\n                        title = 'Mopidy';\n                    }\n\n                    document.title = title;\n                };\n\n                mopidy.play = function (uri) {\n                    mopidy.tracklist.index(mopidy.nowPlaying).then(function (position) {\n                        mopidy.tracklist.add(null, position + 1, null, [uri]).then(function (tracks) {\n                            mopidy.playback.play(tracks[0]);\n                        });\n                    });\n                };\n            });\n        });\n    }\n]);\n\nservices.factory('lastfm', [\n    '$q', '$http',\n    function ($q, $http) {\n        var key = '2b640713cdc23381c5fb5fc3ef65b576';\n        var lastfm = {\n            getAlbum: function (album) {\n                return $http.get(\"http://ws.audioscrobbler.com/2.0/?method=album.getinfo&api_key=\" + key +\n                    \"&artist=\" + encodeURIComponent(album.artists[0].name) +\n                    \"&album=\" + encodeURIComponent(album.name) +\n                    \"&format=json\");\n            },\n            getArtist: function (artist) {\n                return $http.get(\"http://ws.audioscrobbler.com/2.0/?method=artist.getinfo&api_key=\" + key +\n                    \"&artist=\" + encodeURIComponent(artist.name) +\n                    \"&format=json\");\n            },\n            getTrack: function (track) {\n                return $http.get(\"http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=\" + key +\n                    \"&artist=\" + encodeURIComponent(track.artists[0].name) +\n                    \"&track=\" + encodeURIComponent(track.name) +\n                    \"&format=json\");\n            }\n        };\n\n        return lastfm;\n    }\n]);\n\nservices.factory('settings', [\n    '$q', '$http',\n    function($q, $http) {\n        var settings = null;\n\n        var service = {\n            get: function() {\n                var deferred = $q.defer();\n\n                if(settings) {\n                    deferred.resolve(settings);\n                }\n\n                $http.get('/material-webclient/settings').success(function (settings) {\n                    for (var itm in settings) {\n                        if (settings.hasOwnProperty(itm)) {\n                            var subitm = settings[itm];\n                            for (var key in subitm) {\n                                if (subitm.hasOwnProperty(key)) {\n                                    if (subitm[key] === 'true') {\n                                        subitm[key] = true;\n                                    }\n                                }\n                            }\n                        }\n                    }\n\n                    deferred.resolve(settings);\n                });\n\n                return deferred.promise;\n            },\n\n            save: function(data) {\n                var deferred = $q.defer();\n\n                for (var itm in data) {\n                    if (data.hasOwnProperty(itm)) {\n                        var subitm = data[itm];\n                        for (var key in subitm) {\n                            if (subitm.hasOwnProperty(key)) {\n                                if (typeof subitm[key] === 'boolean') {\n                                    subitm[key] = 'true';\n                                }\n                            }\n                        }\n                    }\n                }\n\n                $http.post('/material-webclient/settings', data)\n                    .success(function (response) {\n                        settings = data;\n\n                        $q.resolve();\n                    });\n\n                return deferred.promise;\n            }\n        }\n\n        return service;\n    }\n]);\n"]}